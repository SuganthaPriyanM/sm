CREATE OR REPLACE VIEW p_citirides_details FOLDER = '/zeppelin/derivedviews' AS SELECT citirides_details."D_DATE_SK" AS "D_DATE_SK", citirides_details."D_DATE_ID" AS "D_DATE_ID", citirides_details."D_DATE" AS "D_DATE", citirides_details."D_MONTH_SEQ" AS "D_MONTH_SEQ", citirides_details."D_WEEK_SEQ" AS "D_WEEK_SEQ", citirides_details."D_QUARTER_SEQ" AS "D_QUARTER_SEQ", citirides_details."D_YEAR" AS "D_YEAR", citirides_details."D_DOW" AS "D_DOW", citirides_details."D_MOY" AS "D_MOY", citirides_details."D_DOM" AS "D_DOM", citirides_details."D_QOY" AS "D_QOY", citirides_details."D_FY_YEAR" AS "D_FY_YEAR", citirides_details."D_FY_QUARTER_SEQ" AS "D_FY_QUARTER_SEQ", citirides_details."D_FY_WEEK_SEQ" AS "D_FY_WEEK_SEQ", citirides_details."D_DAY_NAME" AS "D_DAY_NAME", citirides_details."D_QUARTER_NAME" AS "D_QUARTER_NAME", citirides_details."D_HOLIDAY" AS "D_HOLIDAY", citirides_details."D_WEEKEND" AS "D_WEEKEND", citirides_details."D_FOLLOWING_HOLIDAY" AS "D_FOLLOWING_HOLIDAY", citirides_details."D_FIRST_DOM" AS "D_FIRST_DOM", citirides_details."D_LAST_DOM" AS "D_LAST_DOM", citirides_details."D_SAME_DAY_LY" AS "D_SAME_DAY_LY", citirides_details."D_SAME_DAY_LQ" AS "D_SAME_DAY_LQ", citirides_details."D_CURRENT_DAY" AS "D_CURRENT_DAY", citirides_details."D_CURRENT_WEEK" AS "D_CURRENT_WEEK", citirides_details."D_CURRENT_MONTH" AS "D_CURRENT_MONTH", citirides_details."D_CURRENT_QUARTER" AS "D_CURRENT_QUARTER", citirides_details."D_CURRENT_YEAR" AS "D_CURRENT_YEAR", citirides_details."Trips over the past 24-hours (midnight to 11:59pm)" AS "Trips over the past 24-hours (midnight to 11:59pm)", citirides_details."Miles traveled today (midnight to 11:59 pm)" AS "Miles traveled today (midnight to 11:59 pm)", citirides_details."Total Annual Members (All Time)" AS "Total Annual Members (All Time)", citirides_details."24-Hour Passes Purchased (midnight to 11:59 pm)" AS "24-Hour Passes Purchased (midnight to 11:59 pm)", citirides_details."3-Day Passes Purchased (midnight to 11:59 pm)" AS "3-Day Passes Purchased (midnight to 11:59 pm)", citirides_details."Year" AS "Year", citirides_details."Month" AS "Month", citirides_details."Day" AS "Day", citirides_details."Max Temp (F)" AS "Max Temp (F)", citirides_details."Min Temp (F)" AS "Min Temp (F)", citirides_details."Rain (in.)" AS "Rain (in.)", citirides_details."Snow (in.)" AS "Snow (in.)", citirides_details."Snow Cover (in.)" AS "Snow Cover (in.)", citirides_details.date AS date, case "D_HOLIDAY" WHEN 'Y' THEN 1 ELSE 0 END AS is_holiday, case "D_DOW" WHEN 0 THEN 1 ELSE 0 END AS is_sunday, case "D_DOW" WHEN 1 THEN 1 ELSE 0 END AS is_monday, case "D_DOW" WHEN 2 THEN 1 ELSE 0 END AS is_tuesday, case "D_DOW" WHEN 3 THEN 1 ELSE 0 END AS is_wednesday, case "D_DOW" WHEN 4 THEN 1 ELSE 0 END AS is_thursay, case "D_DOW" WHEN 5 THEN 1 ELSE 0 END AS is_friday, case "D_DOW" WHEN 6 THEN 1 ELSE 0 END AS is_saturday, case "D_WEEKEND" WHEN 'Y' THEN 1 ELSE 0 END AS is_weekend FROM citirides_details;

